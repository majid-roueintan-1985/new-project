@model Bnpp.DataLayer.Entities.Events
@{
    ViewData["Title"] = "CraeteEvents";
    Layout = null;
}

<div id="normal">
    <form id="designForm" asp-action="EditEvents" method="post">

        <input type="hidden" asp-for="EventsId" />
        <input type="hidden" asp-for="EventsImage" />
        <input type="hidden" asp-for="MechanicalId" />
        <table cellpadding="3" cellspacing="0">
            <tbody>
                <tr>
                    <td>
                        Event Name:
                    </td>
                    <td>
                        <input asp-for="EventName" type="text" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="EventName"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Event Level:
                    </td>
                    <td>
                        <label>
                            <select asp-for="EventLevel" name="EventLevel" aria-controls="myTable" class="">

                                <option value="Accident">Accident</option>
                                <option value="Perturbation">Perturbation</option>
                                <option value="Deviation">Deviation</option>
                                <option value="Low Level">Low Level</option>
                                <option value="Near Miss">Near Miss</option>
                            </select>
                        </label>
                    </td>
                </tr>
                <tr>
                    <td>
                        Event Date:
                    </td>
                    <td>
                        <input name="EventDate" asp-for="EventDate" onkeydown="return false;" style="direction: ltr; text-align: left;">
                    </td>
                </tr>
                <tr>
                    <td>
                        Event Time:
                    </td>
                    <td>
                        <input name="EventTime" asp-for="EventTime" onkeydown="return false;" style="direction: ltr; text-align: left;">
                    </td>
                </tr>
                <tr>
                    <td>
                        Report Date:
                    </td>
                    <td>
                        <input name="ReportDate" asp-for="ReportDate" onkeydown="return false;" style="direction: ltr; text-align: left;">
                    </td>
                </tr>
                <tr>
                    <td>
                        Report No:
                    </td>
                    <td>
                        <input asp-for="ReportNo" type="text" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="ReportNo"></span>
                    </td>
                </tr>

                <tr>
                    <td>
                        Responsible Unit:
                    </td>
                    <td>
                        <label>
                            <select asp-for="ResponsibleUnit" name="responsibleUnit" aria-controls="myTable" class="">
                                <option value="Fuel and Nuclear Safety Management">Fuel and Nuclear Safety Management</option>
                                <option value="Radiation Safety Management">Radiation Safety Management</option>
                                <option value="Radioactive Waste Treatment Workshop">Radioactive Waste Treatment Workshop</option>
                                <option value="Environmental Protection and Environmental Monitoring Lab">Environmental Protection and Environmental Monitoring Lab</option>
                                <option value="Emergency Planning Management">Emergency Planning Management</option>
                                <option value="Industrial Safety Management">Industrial Safety Management</option>
                                <option value="Electrical Management">Electrical Management</option>
                                <option value="Automated Process Control System Manegement">Automated Process Control System Manegement</option>
                                <option value="Process Senior Engineer Management">Process Senior Engineer Management</option>
                                <option value="Reactor Management">Reactor Management</option>
                                <option value="Turbine Management">Turbine Management</option>
                                <option value="Chemical Engineering Management">Chemical Engineering Management</option>
                                <option value="Ventilation and Chilling Management">Ventilation and Chilling Management</option>
                                <option value="Common Eqiupment Management">Common Eqiupment Management</option>
                                <option value="Maintenance and Repairs Division">Maintenance and Repairs Division</option>
                                <option value="Repairs Support and Decontamination Management">Repairs Support and Decontamination Management</option>
                                <option value="Mechanical Repairs Management">Mechanical Repairs Management</option>
                            </select>
                        </label>
                    </td>
                </tr>

                <tr>
                    <td>
                        Event Location:
                    </td>
                    <td>
                        <input asp-for="EventLocation" type="text" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="EventLocation"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Related Ageing Mechanism:
                    </td>
                    <td>
                        <select name="system" asp-for="RelatedAgeingMechanism" asp-items="@ViewBag.AgeingMechanism as SelectList" aria-controls="myTable" class="">
                            @*<option value="">Select</option>*@
                        </select>
                    </td>
                    <td>
                        <span asp-validation-for="RelatedAgeingMechanism"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Description:
                    </td>
                    <td>
                        <input asp-for="Description" type="text" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="Description"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        File Name:
                    </td>

                    <td>
                        <input asp-for="Filename" type="text" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="Filename"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Select File:
                    </td>
                    <td>
                        <input type="file" name="imgEventUp" id="imgEventUp" style="direction: ltr; text-align: left;">
                    </td>
                </tr>
                <tr>
                    <td>
                        <h1 id="iH1">
                            Status Before Event
                        </h1>
                    </td>
                </tr>
                <tr>
                    <td>
                        Operating Modes:
                    </td>
                    <td>
                        <label>
                            <select asp-for="BeforeOperatingModes" aria-controls="myTable" class="">
                                <option value="">Select</option>
                                <option value="Operation at power">Operation at power</option>
                                <option value="Minimally Controlled Level of Power (MCL)">Minimally Controlled Level of Power (MCL)</option>
                                <option value="Hot Condition">Hot Condition</option>
                                <option value="Cold Condition">Cold Condition</option>
                                <option value="Shutdown for Repair">Shutdown for Repair</option>
                                <option value="Refueling">Refueling</option>
                                <option value="Transient Mode">Transient Mode</option>
                            </select>
                        </label>
                    </td>
                </tr>
                <tr>
                    <td>
                        Heat Power(MW):
                    </td>
                    <td>
                        <input asp-for="BeforeHeatPower" type="number" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="BeforeHeatPower"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Electrical Power(MW):
                    </td>
                    <td>
                        <input asp-for="BeforeElectricalPower" type="number" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="BeforeElectricalPower"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        No. of Effective Working Days(Days):
                    </td>
                    <td>
                        <input asp-for="BeforeEffectiveWorkingDays" type="number" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="BeforeEffectiveWorkingDays"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Level of Pressure Water(M):
                    </td>
                    <td>
                        <input asp-for="BeforePressureWater" type="number"  style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="BeforePressureWater"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Pressure in First Circuit(MPa):
                    </td>
                    <td>
                        <input asp-for="BeforePressureinFirstCircuit" type="number"  style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="BeforePressureinFirstCircuit"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Pressure in Second Circuit(MPa):
                    </td>
                    <td>
                        <input asp-for="BeforePressureinSecondCircuit" type="number"  style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="BeforePressureinSecondCircuit"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Vaccum in Condensor(KPa):
                    </td>
                    <td>
                        <input asp-for="BeforeVaccuminCondensor" type="number"  style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="BeforeVaccuminCondensor"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        <h1 id="iH1">
                            Status After Event
                        </h1>
                    </td>
                </tr>
                <tr>
                    <td>
                        Operating Modes:
                    </td>
                    <td>
                        <label>
                            <select asp-for="AfterOperatingModes" aria-controls="myTable" class="">
                                <option value="">Select</option>
                                <option value="Operation at power">Operation at power</option>
                                <option value="Minimally Controlled Level of Power (MCL)">Minimally Controlled Level of Power (MCL)</option>
                                <option value="Hot Condition">Hot Condition</option>
                                <option value="Cold Condition">Cold Condition</option>
                                <option value="Shutdown for Repair">Shutdown for Repair</option>
                                <option value="Refueling">Refueling</option>
                                <option value="Transient Mode">Transient Mode</option>
                            </select>
                        </label>
                    </td>
                </tr>
                <tr>
                    <td>
                        Heat Power(MW):
                    </td>
                    <td>
                        <input asp-for="AfterHeatPower" type="number" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="AfterHeatPower"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Electrical Power(MW):
                    </td>
                    <td>
                        <input asp-for="AfterElectricalPower" type="number" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="AfterElectricalPower"></span>
                    </td>
                </tr>

                <tr>
                    <td>
                        No. of Effective Working Days(Days):
                    </td>
                    <td>
                        <input asp-for="AfterEffectiveWorkingDays" type="number" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="AfterEffectiveWorkingDays"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Level of Pressure Water(M):
                    </td>
                    <td>
                        <input asp-for="AfterPressureWater" type="number"  style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="AfterPressureWater"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Pressure in First Circuit(MPa):
                    </td>
                    <td>
                        <input asp-for="AfterPressureinFirstCircuit" type="number"  style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="AfterPressureinFirstCircuit"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Pressure in Second Circuit(MPa):
                    </td>
                    <td>
                        <input asp-for="AfterPressureinSecondCircuit" type="number"  style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="AfterPressureinSecondCircuit"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Vaccum in Condensor(KPa):
                    </td>
                    <td>
                        <input asp-for="AfterVaccuminCondensor" type="number"  style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="AfterVaccuminCondensor"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="button" @*onclick="AjaxdocumentFormSubmit()"*@ value="Save" id="btnGet" class="butn-save" style="direction: ltr; text-align: left;">
                        <input type="button" onclick="location='/Events/InternalEvents/@Model.MechanicalId'" value="Cancel" id="Button2" class="butn-cancel" style="direction: ltr; text-align: left;">
                    </td>
                </tr>
            </tbody>
        </table>
    </form>
</div>


<link href="/css/kendo.common.min.css" rel="stylesheet" />
<link href="/css/kendo.rtl.min.css" rel="stylesheet" />
<link href="/css/kendo.default.min.css" rel="stylesheet" />

<script src="/js/jquery.min.js"></script>
<script src="/js/kendo.web.min.js"></script>
<script src="/js/kendo.all.min.js"></script>
<script src="~/js/jquery.validate.min.js"></script>
<script src="~/js/jquery.validate.unobtrusive.min.js"></script>

<!-- Jalali Date Picker -->
<script src="/js/jalali/fa-IR.js"></script>
<script src="/js/jalali/JalaliDate.js"></script>
<script src="/js/jalali/kendo.core.js"></script>
<script src="/js/jalali/kendo.calendar.js"></script>
<script src="/js/jalali/kendo.datepicker.js"></script>

<script>
    // create DatePicker from input HTML element
    //$("#Dates").kendoTimePicker({
    //    timeFormat: "HH:mm" //24 hours format
    //});

    $(document).ready(function () {
        kendo.culture("fa-IR");

        $('#EventDate').kendoDatePicker({
            min: new JalaliDate(1350, 1, 1),
            max: new JalaliDate(1430, 1, 17),

        });
    });


    $(document).ready(function () {
        kendo.culture("fa-IR");

        $('#ReportDate').kendoDatePicker({
            min: new JalaliDate(1350, 1, 1),
            max: new JalaliDate(1430, 1, 17),

        });
    });

    $("#EventTime").kendoTimePicker({
        //timeFormat: "kk:mm" //24 hours format
        format: " HH:mm", parseFormats: ["HH:mm"], timeFormat: "HH:mm"
    });


</script>

<script type="text/javascript">

    $('#btnGet').click(function () {

        if ($("#designForm").valid()) {
            AjaxdocumentFormSubmit();
        }
        else {
            return false;
        }
    });

    function AjaxdocumentFormSubmit() {
        //Set the URL.
        var url = $("#designForm").attr("action");
        //Add the Field values to FormData object.

        var formData = new FormData();
        formData.append("EventName", $("#EventName").val());
        formData.append("EventLevel", $("#EventLevel").val());
        formData.append("ReportNo", $("#ReportNo").val());
        formData.append("ResponsibleUnit", $("#ResponsibleUnit").val());
        formData.append("EventLocation", $("#EventLocation").val());
        formData.append("Filename", $("#Filename").val());
        formData.append("EventDate", $("#EventDate").val());
        formData.append("EventTime", $("#EventTime").val());
        formData.append("ReportDate", $("#ReportDate").val());
        formData.append("RelatedAgeingMechanism", $("#RelatedAgeingMechanism").val());
        formData.append("Description", $("#Description").val());
        formData.append("EventConsequences", $("#EventConsequences").val());
        formData.append("EventsId", $("#EventsId").val());
        formData.append("EventsImage", $("#EventsImage").val());

        //Before
        formData.append("BeforeParameter", $("#BeforeParameter").val());
        formData.append("BeforeOperatingModes", $("#BeforeOperatingModes").val());
        formData.append("BeforeHeatPower", $("#BeforeHeatPower").val());
        formData.append("BeforeElectricalPower", $("#BeforeElectricalPower").val());
        formData.append("BeforeEffectiveWorkingDays", $("#BeforeEffectiveWorkingDays").val());
        formData.append("BeforePressureWater", $("#BeforePressureWater").val());
        formData.append("BeforePressureinFirstCircuit", $("#BeforePressureinFirstCircuit").val());
        formData.append("BeforePressureinSecondCircuit", $("#BeforePressureinSecondCircuit").val());
        formData.append("BeforeVaccuminCondensor", $("#BeforeVaccuminCondensor").val());

        //After
        formData.append("AfterParameter", $("#AfterParameter").val());
        formData.append("AfterOperatingModes", $("#AfterOperatingModes").val());
        formData.append("AfterHeatPower", $("#AfterHeatPower").val());
        formData.append("AfterElectricalPower", $("#AfterElectricalPower").val());
        formData.append("AfterEffectiveWorkingDays", $("#AfterEffectiveWorkingDays").val());
        formData.append("AfterPressureWater", $("#AfterPressureWater").val());
        formData.append("AfterPressureinFirstCircuit", $("#AfterPressureinFirstCircuit").val());
        formData.append("AfterPressureinSecondCircuit", $("#AfterPressureinSecondCircuit").val());
        formData.append("AfterVaccuminCondensor", $("#AfterVaccuminCondensor").val());
        formData.append("MechanicalId", $("#MechanicalId").val());

        formData.append("fileEvents", $("#imgEventUp")[0].files[0]);

        $.ajax({
            type: 'POST',
            url: url,
            data: formData,
            processData: false,
            contentType: false
        }).done(function () {
            window.location.href = "/Events/InternalEvents/@Model.MechanicalId";
        });
    }

    function showMechanicalPage() {
        $("#newPage").load("/Technical/HeatTreatment/");
    }

    function readURL(input) {

        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#imgCourse').attr('src', e.target.result);
            }

            reader.readAsDataURL(input.files[0]);
        }
    }

    $("#imgCourseUp").change(function () {
        readURL(this);
    });

    $('input[type=file]').change(function () {

        $('#Filename').attr('value', this.files[0].name);
    });
</script>
