@model Bnpp.DataLayer.Entities.InspectionData.InspectionDocument
@{
    ViewData["Title"] = "CreateGeneralDocument";
    Layout =null;
}

<div id="normal">
    <form id="DesignDocumentForm" asp-action="CreateGeneralDocument" method="post" enctype="multipart/form-data">
        <input type="hidden" asp-for="MechanicalId" value="@ViewBag.MechanicalId" />
        <table cellpadding="3" cellspacing="0">
            <tbody>
                <tr>
                    <td>
                        Code:
                    </td>
                    <td>
                        <input asp-for="Code" type="text" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="Code"></span>
                    </td>
                </tr>
               @*  <tr>
                    <td>
                        File Name:
                    </td>

                    <td>
                        <input asp-for="Filename" type="text"  value="" style="direction: ltr; text-align: left;">
                    </td>
                    <td>
                        <span asp-validation-for="Filename"></span>
                    </td>
                </tr> *@
                <tr>
                    <td>
                        Select File:
                    </td>
                    <td>
                        <input type="file" multiple="multiple" name="imgGeneraUp" id="imgGeneraUp" style="direction: ltr; text-align: left;">
                    </td>
                </tr>
              @*   <tr>
                    <td>
                        Doc. Name:
                    </td>
                    <td>
                        <input asp-for="DocumentName" type="text"  style="direction: ltr; text-align: left;">
                    </td>
                </tr> *@

                <tr>
                    <td>
                        <input type="button" onclick="AjaxdocumentFormSubmit()" value="Save" class="butn-save" style="direction: ltr; text-align: left;">
                        <input type="button" onclick="showsubPage8()" value="Cancel" id="Button2" class="butn-cancel" style="direction: ltr; text-align: left;">
                    </td>
                </tr>
            </tbody>
        </table>
    </form>
</div>



<link href="/css/kendo.common.min.css" rel="stylesheet" />
<link href="/css/kendo.default.min.css" rel="stylesheet" />

<script src="/js/jquery.min.js"></script>
<script src="/js/kendo.all.min.js"></script>
<script src="~/js/jquery.validate.min.js"></script>
<script src="~/js/jquery.validate.unobtrusive.min.js"></script>

<script>
    // create DatePicker from input HTML element
    $("#VisualDate").kendoDatePicker();
</script>

<script type="text/javascript">
    function AjaxdocumentFormSubmit() {
        //Set the URL.
        var url = $("#DesignDocumentForm").attr("action");
        //Add the Field values to FormData object.
        var formData = new FormData();

        debugger;
        formData.append("Code", $("#Code").val());


        // formData.append("Filename", $("#Filename").val());
        formData.append("DocumentName", $("#DocumentName").val());
        formData.append("MechanicalId", $("#MechanicalId").val());

        // formData.append("fileGeneral", $("#imgGeneraUp")[0].files[0]);
        var files = $("#imgGeneraUp").get(0).files;
        for (var i = 0; i < files.length; i++) {
            formData.append("fileGeneral", files[i]);
        }


        $.ajax({
            type: 'POST',
            url: url,
            data: formData,
            processData: false,
            contentType: false
        }).done(function () {
            $("#Tabs").load("/Technical/GeneralData/@ViewBag.MechanicalId");
        });

    }

    function readURL(input) {

        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#imgGeneraUp').attr('src', e.target.result);
            }

            reader.readAsDataURL(input.files[0]);
        }
    }

    $("#imgGeneraUp").change(function () {
        readURL(this);
    });

    $('input[type=file]').change(function () {

        $('#Filename').attr('value', this.files[0].name);
    });
</script>



